{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "DenyAllWithoutMFA",
            "Effect": "Deny",
            "Action": "*",
            "Resource": "*",
            "Condition": {
                "BoolIfExists": {
                    "aws:MultiFactorAuthPresent": "false"
                }
            }
        },
        {
            "Sid": "ReadOnlyAccess",
            "Effect": "Allow",
            "Action": [
                "s3:List*",
                "s3:Get*",
                "cloudwatch:Describe*",
                "cloudwatch:Get*",
                "cloudwatch:List*",
                "access-analyzer:ValidatePolicy"
            ],
            "Resource": "*"
        },
        {
            "Sid": "InfrastructureManagement",
            "Effect": "Allow",
            "Action": [
                "ec2:Describe*",
                "ec2:Get*",
                "ec2:List*",
                "ec2:*SecurityGroup*",
                "ec2:*Vpc*",
                "ec2:*Subnet*",
                "ec2:*Route*",
                "ec2:*Endpoint*",
                "ec2:*InternetGateway*",
                "ec2:*Address*",
                "ec2:*LaunchTemplate*",
                "ec2:*Volume*",
                "ec2:*Tags*",
                "ec2:*NetworkInterface*",
                "ec2:StartInstances",
                "ec2:StopInstances",
                "ec2:RebootInstances",
                "ec2:TerminateInstances",
                "ec2:ModifyInstanceAttribute",
                "ec2-instance-connect:SendSSHPublicKey",
                "ec2-instance-connect:OpenTunnel",
                "elasticloadbalancing:*",
                "autoscaling:*",
                "rds:*",
                "cloudformation:*"
            ],
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "aws:RequestedRegion": "ap-northeast-3"
                }
            }
        },
        {
            "Sid": "SecureRunInstancesInstanceCheck",
            "Effect": "Allow",
            "Action": "ec2:RunInstances",
            "Resource": "arn:aws:ec2:*:*:instance/*",
            "Condition": {
                "StringEquals": {
                    "aws:RequestedRegion": "ap-northeast-3"
                },
                "StringLike": {
                    "ec2:InstanceType": [
                        "t2.*",
                        "t3.*",
                        "m5.*"
                    ]
                }
            }
        },
        {
            "Sid": "SecureRunInstancesSupportingResources",
            "Effect": "Allow",
            "Action": "ec2:RunInstances",
            "Resource": [
                "arn:aws:ec2:*:*:launch-template/*",
                "arn:aws:ec2:*:*:subnet/*",
                "arn:aws:ec2:*:*:network-interface/*",
                "arn:aws:ec2:*:*:volume/*",
                "arn:aws:ec2:*:*:security-group/*",
                "arn:aws:ec2:*:*:image/*"
            ],
            "Condition": {
                "StringEquals": {
                    "aws:RequestedRegion": "ap-northeast-3"
                }
            }
        },
        {
            "Sid": "CreateServiceLinkedRole",
            "Effect": "Allow",
            "Action": "iam:CreateServiceLinkedRole",
            "Resource": "arn:aws:iam::*:role/aws-service-role/*",
            "Condition": {
                "StringLike": {
                    "iam:AWSServiceName": [
                        "autoscaling.amazonaws.com",
                        "elasticloadbalancing.amazonaws.com",
                        "rds.amazonaws.com"
                    ]
                }
            }
        },
        {
            "Sid": "AllowGetAMIParameters",
            "Effect": "Allow",
            "Action": "ssm:GetParameters",
            "Resource": "arn:aws:ssm:ap-northeast-3::parameter/aws/service/ami-amazon-linux-latest/*"
        },
        {
            "Sid": "S3DeployBucketAccess",
            "Effect": "Allow",
            "Action": [
                "s3:PutObject",
                "s3:GetObject",
                "s3:DeleteObject",
                "s3:PutEncryptionConfiguration",
                "s3:GetEncryptionConfiguration"
            ],
            "Resource": [
                "arn:aws:s3:::REPLACE-WITH-YOUR-BUCKET-NAME",
                "arn:aws:s3:::REPLACE-WITH-YOUR-BUCKET-NAME/*"
            ]
        }
    ]
}